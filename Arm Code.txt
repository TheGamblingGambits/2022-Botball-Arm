#include <kipr/wombat.h>

int main()
{
    enable_servos();               //Set Servos to proper position
    set_servo_position(2, 150);
    msleep(2000);
    set_servo_position(3,1750);
    msleep(2000);
    set_servo_position(2, 800);    //Clamp the cubes

    msleep(2000);

    set_servo_position(3, 700);    //lift the cubes

    msleep(500);

    while(analog(2)<1600) // detect first black line
    {
        mav(0,500);
        mav(3,500);
    }

    cmpc(3);                 //right turn after detecting first black line
    while (gmpc(3) < 1100){
        mav(0, -500);
        mav(3, 500);
    }

    cmpc(3);
    while (gmpc(3) < 3100){
        mav(0, 700);
        mav(3, 700);
    }

    cmpc(0);
    while (gmpc(0) < 1290){ //left turn
        mav(0, 500);
        mav(3, -500);
    }

    while(analog(2)<1600)  //detect second line (doesn't adjust)
    {
        mav(0,1000);
        mav(3,1000);
    }
    
    msleep(200);

    cmpc(0);
    while (gmpc(0) < 13050)  //long run to drop-off
    {
        mav(0,1000);
        mav(3,1000);
    }
    
    set_servo_position(2, 150);    //drop the cubes
    set_servo_position(3, 900);
    
    cmpc(0);                     //back up after drop-off
    while (gmpc(0) > -3500){
        mav(0, -500);
        mav(3, -500);
    }
    ao();
    return 0;
}
